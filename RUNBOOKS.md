## Claude Code — Auth (CLI Login)
_Updated: 2025-10-15 18:26 (Europe/Warsaw)_

### Цель
Единый способ аутентифицировать CLI Claude Code на headless-узлах, не раскрывая секреты в терминале.

### Шаги

1) Запуск логина:
```bash
claude setup-token
```
Следуйте ссылке в браузере (VS Code helper/xdg-open). Требуется учётка Claude Pro/Max.

2) Проверка статуса в REPL:
```bash
# откройте REPL
claude
# внутри REPL введите:
/config
/exit
```

3) Альтернатива (скриптом, без ручного ввода):
```bash
# покажет конфигурацию и завершит сессию
printf "/config\n/exit\n" | claude
```

### Валидация (ожидается)
- Каталоги `~/.claude` и файл `~/.claude.json` присутствуют; токен **не** публикуется в логи.
- В выводе `/config` видны тип учётки (Pro/Max) и активная модель.
- Любые отказы/ошибки — приложить лог `claude setup-token` и создать CR.

### Безопасность
- Запрещено вставлять токены/секреты в тикеты/логи/PR.
- В `~/.claude.json` хранится долгоживущий токен — бережно обращаться; **не коммитить**.
- Режим `--dangerously-skip-permissions` не использовать на хосте разработки.

### Гео-ограничения и соответствие ToS
_Updated: 2025-10-15 19:15 (Europe/Warsaw)_

Claude Code может быть недоступен из некоторых регионов. Рекомендованный порядок:
1) Запуск CLI на узле в **разрешённом регионе** (напр., Польша/ЕС/США): VM/GitHub Codespaces/другой провайдер с белым egress.
2) Корпоративный egress через одобренный шлюз, соответствующий условиям сервиса.
3) **Запрещается** использовать неавторизованные прокси/туннели для обхода геоограничений.
4) При ошибке `403 … Please run /login`: повторить `/login` после успешного setup-token, проверить, что узел находится в разрешённой юрисдикции.
