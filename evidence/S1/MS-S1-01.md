# Evidence â€” MS-S1-01 (Warsaw)
- Timestamp: 2025-10-03 22:23 CEST
## Idempotent apply (two runs)
### Apply #1
SET
CREATE SCHEMA
CREATE TABLE
CREATE TABLE
CREATE TABLE
CREATE FUNCTION
DO
CREATE INDEX
CREATE INDEX
CREATE INDEX
CREATE INDEX
CREATE INDEX
CREATE INDEX
COMMENT
COMMENT
COMMENT
COMMENT
### Apply #2 (repeat)
SET
CREATE SCHEMA
CREATE TABLE
CREATE TABLE
CREATE TABLE
CREATE FUNCTION
DO
CREATE INDEX
CREATE INDEX
CREATE INDEX
CREATE INDEX
CREATE INDEX
CREATE INDEX
COMMENT
COMMENT
COMMENT
COMMENT

## Test inserts (users, sessions, audit) and updated_at before/after
### Inserts (upsert-safe)
SET
INSERT 0 1
     tag      | tg_user_id |      updated_at_warsaw      
--------------+------------+-----------------------------
 users_before |       9101 | 2025-10-03 22:23:21.210951 
(1 row)

UPDATE 1
     tag     | tg_user_id |      updated_at_warsaw      
-------------+------------+-----------------------------
 users_after |       9101 | 2025-10-03 22:23:21.214584 
(1 row)

SET
INSERT 0 0
       tag       | chat_id |      updated_at_warsaw      
-----------------+---------+-----------------------------
 sessions_before |    9101 | 2025-10-03 22:14:17.912303 
(1 row)

UPDATE 1
      tag       | chat_id |      updated_at_warsaw      
----------------+---------+-----------------------------
 sessions_after |    9101 | 2025-10-03 22:23:21.277308 
(1 row)

SET
INSERT 0 1
    tag     | id | tg_user_id | chat_id |   event   |      at_warsaw       | data 
------------+----+------------+---------+-----------+----------------------+------
 audit_last |  2 |       9101 |    9101 | BOT_START | 2025-10-03 22:23:21  | {}
(1 row)


## Final snapshot: tables, columns, indexes, triggers
### \dt tg_bot.*
          List of relations
 Schema |   Name   | Type  |  Owner   
--------+----------+-------+----------
 tg_bot | audit    | table | gen_user
 tg_bot | sessions | table | gen_user
 tg_bot | users    | table | gen_user
(3 rows)

### Columns
audit.id	bigint	nextval('tg_bot.audit_id_seq'::regclass)
audit.at	timestamp with time zone	now()
audit.tg_user_id	bigint	
audit.chat_id	bigint	
audit.event	text	
audit.data	jsonb	
sessions.chat_id	bigint	
sessions.last_invoice_id	bigint	
sessions.last_vin	text	
sessions.state	jsonb	
sessions.updated_at	timestamp with time zone	now()
users.tg_user_id	bigint	
users.username	text	
users.lang	text	'ru'::text
users.created_at	timestamp with time zone	now()
users.updated_at	timestamp with time zone	now()
### Indexes
audit	audit_pkey
audit	idx_audit_at
audit	idx_audit_at_brin
audit	idx_audit_chat_id
audit	idx_audit_tg_user_id
sessions	idx_sessions_updated_at
sessions	sessions_pkey
users	idx_users_lang
users	users_pkey
### Triggers
ERROR:  syntax error at or near "table"
LINE 7: ORDER BY table, trigger;
                 ^
